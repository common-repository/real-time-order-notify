<?php /*** @package Real-time Order Notify* @version 1.0.4*//*Plugin Name: Real-time Order NotifyPlugin URI: http://wapiwp.comDescription: Stay on top of your WooCommerce orders with Real-time Order Notify. Get instant notifications via WhatsApp and never miss a customer order again. Keep your business running smoothly with this must-have plugin. Author: WapiWPText Domain: real-time-order-notifyVersion: 8.1*/define( 'WOAAPIURL', 'https://wapiwp.com/orderpush/api.php' );add_action('admin_menu', 'woa_menu');function woa_menu(){  add_menu_page('Real-time Order Notify','Real-time Order Notify', 'manage_options', 'woa_panel', 'woa_panel', plugins_url( '/assets/images/icon.png', __FILE__ ), 25);}function woa_panel() {  require_once("settings.php");}function woapompake_form_enqueue_scripts() {  wp_enqueue_script( 'woa-alert-js', plugins_url( '/assets/js/woa_alert.js', __FILE__ ) , array(), false, true );  wp_enqueue_script( 'woa-script', plugins_url( '/assets/js/woa_form.js', __FILE__ ), array('jquery'), false, true );      wp_enqueue_style( 'woa-ubuntu-font', '//fonts.googleapis.com/css?family=Ubuntu' );  wp_enqueue_style( 'woa-style', plugins_url( '/assets/css/woa_form.css', __FILE__ )."?".rand(10000,99999) );  wp_localize_script( 'woa-script', 'woa_form_ajax', array(    'ajax_url' => admin_url( 'admin-ajax.php' ),    'ajax_nonce' => wp_create_nonce('woa_ajax_nonce'),  ));}add_action( 'wp_enqueue_scripts', 'woapompake_form_enqueue_scripts' );function woapompake_form_admin_enqueue_scripts($hook) {     if($hook!= 'toplevel_page_woa_panel') {            return;        }    wp_enqueue_style( 'woa-admin-bootstrap4-css', plugins_url( '/assets/css/bootstrap.min.css', __FILE__ ) );    wp_enqueue_style( 'woa-admin-style', plugins_url( '/assets/css/woa_form_admin.css', __FILE__ ) );    wp_enqueue_style( 'woa-admin-colorpicker', plugins_url( '/assets/css/tinycolorpicker.css', __FILE__ ) );    wp_enqueue_script( 'woa-admin-fa-icon', "https://use.fontawesome.com/releases/v5.14.0/js/all.js", array(), '5.14.0', true);	wp_enqueue_script( 'woa-admin-bootstrap4-js', plugins_url( '/assets/js/bootstrap.bundle.min.js', __FILE__ ) , array(), false, true );    wp_enqueue_script( 'woa-admin-colorpicker-js', plugins_url( '/assets/js/jquery.tinycolorpicker.js', __FILE__ ) , array(), false, true );    wp_enqueue_script( 'woa-admin-js', plugins_url( '/assets/js/woa_admin.js', __FILE__ ) , array(), false, true );  }add_action( 'admin_enqueue_scripts', 'woapompake_form_admin_enqueue_scripts' );function woapompake_form_ajax() {  check_ajax_referer( 'woa_ajax_nonce', 'security' );  $woa_apikey = get_option("woa_apikey");  $woa_phone = get_option("woa_phone");  if( !$_POST['data'] ) {    return false;  }  wp_die();}add_action( 'wp_ajax_nopriv_woa_form_ajax', 'woapompake_form_ajax' );add_action( 'wp_ajax_woa_form_ajax', 'woapompake_form_ajax' );function woapompakelog_order_full_info( $order_id ) {  $order = wc_get_order( $order_id );  $items = $order->get_items();    $product_data = array();  foreach ( $items as $item ) {    $product_name = $item->get_name();    $product_quantity = $item->get_quantity();    $product_data[] = "$product_name x $product_quantity";  }  $shipping_address_array = $order->get_address( 'shipping' );$shipping_address  = $shipping_address_array['first_name'] . ' ' . $shipping_address_array['last_name'] . " - ";$shipping_address .= $shipping_address_array['company'] . " - ";$shipping_address .= $shipping_address_array['address_1'] . " - ";$shipping_address .= $shipping_address_array['address_2'] . " - ";$shipping_address .= $shipping_address_array['city'] . ', ' . $shipping_address_array['state'] . ' ' . $shipping_address_array['postcode'] . " - ";$shipping_address .= $shipping_address_array['country'];      $customer_name = $order->get_billing_first_name() . ' ' . $order->get_billing_last_name();  $customer_email = $order->get_billing_email();  $customer_phone = $order->get_billing_phone();  $order_total = $order->get_total();  $order_date = $order->get_date_created()->format( 'Y-m-d H:i:s' );  $order_status = $order->get_status();  $payment_method = $order->get_payment_method_title();  $woa_apikey = get_option("woa_apikey");  $woa_phone = get_option("woa_phone");  $siteUrl = get_site_url();  $ip_address = sanitize_text_field($_SERVER['REMOTE_ADDR']);    $url = "https://wapiwp.com/api/orderpush/?apikey=".$woa_apikey;                   $response = wp_remote_post( $url, array(                    'method'      => 'POST',                    'timeout'     => 45,                    'redirection' => 5,                    'httpversion' => '1.0',                    'blocking'    => true,                    'headers'     => array(),                    'body'        => array(                      'adminPhone' => $woa_phone,					  'orderid' => $order_id,					  'customer_name' => $customer_name,					  'customer_email' => $customer_email,					  'customer_phone' => $customer_phone,					  'order_total' => $order_total,					  'order_date' => $order_date,					  'order_status' => $order_status,					  'payment_method' => $payment_method,					  'shipping_address' => $shipping_address,					  'siteUrl' => $siteUrl,					  'ip_address' => $ip_address,					  'productname' => implode( ', ', $product_data )                                                                ),                    'cookies'     => array()                  )                 );}add_action( 'woocommerce_thankyou', 'woapompakelog_order_full_info' );function woapompakeload_dashicons(){    wp_enqueue_style('dashicons');}add_action('wp_enqueue_scripts', 'woapompakeload_dashicons');add_filter( 'plugin_action_links_' . plugin_basename(__FILE__), 'woapompakeadd_action_links' );function woapompakeadd_action_links ( $links ) {    $woa_adsettings = array(        '<a href="' . admin_url( 'admin.php?page=woa_panel' ) . '">Real-time Order Notify</a>',                '<a href="' . esc_url( 'https://wapiwp.com/magaza' ) . '" target="_blank" style="font-weight:bold;">' . esc_html__( 'Add Credits', 'real-time-order-notify' ) . '</a>',        '<a href="' . esc_url( 'https://wordpress.org/plugins/Real-time-Order-Notify/#installation' ) . '" target="_blank">' . esc_html__( 'Installation Guide', 'real-time-order-notify' ) . '</a>'    );    return array_merge( $links, $woa_adsettings );}add_filter( 'plugin_row_meta', 'woapompakewk_plugin_row_meta', 10 ,2);function woapompakewk_plugin_row_meta( $links, $file ) {        if ( plugin_basename( __FILE__ ) == $file ) {        $row_meta = array(          'docs'    => '<a href="' . esc_url( 'https://login.wordpress.org/?redirect_to=https://wordpress.org/support/plugin/Real-time-Order-Notify/reviews/?rate=5#new-post' ) . '" target="_blank" style="color:red; font-weight:bold;">' . esc_html__( 'Rate', 'real-time-order-notify' ) . '</a>',          'sorun'    => '<a href="' . esc_url( 'https://wapiwp.com/iletisim/' ) . '" target="_blank" style="color:green;">' . esc_html__( 'Report a Problem', 'real-time-order-notify' ) . '</a>'		          );        return array_merge( $links, $row_meta );    }    return (array) $links;}?>